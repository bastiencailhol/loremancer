<div class="container mx-auto flex justify-between">
  <div class="banner flex items-baseline gap-x-8 text-white pl-4 pr-20 py-8">
    <h1 class="font-bold tracking-wide">✨ Sparkles</h1>
    <p class="font-medium tracking-widest">
      Your creative companion to ignite your hero design ideas.
    </p>
  </div>
  <div>
    <button
      type="button"
      (click)="rollAllTraits()"
      class="
        py-2
        px-4
        mb-5
        bg-indigo-600
        hover:bg-indigo-700
        text-white
        w-full
        transition
        ease-in
        duration-200
        text-center text-base
        font-semibold
        shadow-md
        rounded-lg
      "
    >
      Générer
    </button>
  </div>
</div>
<div class="container mx-auto px-4 py-5">
  <div class="grid grid-cols-3 gap-12">
    <div class="col-span-1">
      <div class="relative mb-8">
        <div class="flex mb-3">
          <h4 class="flex-grow">Caractéristiques</h4>
          <div class="flex gap-1 px-3">
            <app-reroll-button
              *ngIf="!coreTraitsCategory.locked"
              (onClick)="rollCategoryTraits(coreTraitsCategory)"
            ></app-reroll-button>
            <app-lock-button
              (onClick)="toggleCategoryLock(coreTraitsCategory)"
              [isLocked]="coreTraitsCategory.locked"
            ></app-lock-button>
          </div>
        </div>
        <div class="card">
          <div
            *ngFor="let trait of coreTraitsCategory.traits; let isLast = last"
            [class.mb-6]="!isLast"
          >
            <ng-container
              *ngTemplateOutlet="
                randomizedTrait;
                context: { category: coreTraitsCategory, trait: trait }
              "
            ></ng-container>
          </div>
        </div>
      </div>
      <div class="relative mb-8">
        <div class="flex mb-3">
          <h4 class="flex-grow">Attributs physiques</h4>
          <div class="flex gap-1 px-3">
            <app-reroll-button
              *ngIf="!physicalTraitsCategory.locked"
              (onClick)="rollCategoryTraits(physicalTraitsCategory)"
            ></app-reroll-button>
            <app-lock-button
              (onClick)="toggleCategoryLock(physicalTraitsCategory)"
              [isLocked]="physicalTraitsCategory.locked"
            ></app-lock-button>
          </div>
        </div>
        <div class="card">
          <div
            *ngFor="
              let trait of physicalTraitsCategory.traits;
              let isLast = last
            "
            [class.mb-6]="!isLast"
          >
            <ng-container
              *ngTemplateOutlet="
                randomizedTrait;
                context: { category: physicalTraitsCategory, trait: trait }
              "
            ></ng-container>
          </div>
        </div>
      </div>
    </div>
    <div class="col-span-2 relative mb-8">
      <div class="flex">
        <h4 class="flex-grow mb-3">Équipements</h4>
        <div class="flex gap-1 px-3">
          <app-reroll-button
            *ngIf="!equipmentsCategory.locked"
            (onClick)="rollCategoryTraits(equipmentsCategory)"
          ></app-reroll-button>
          <app-lock-button
            (onClick)="toggleCategoryLock(equipmentsCategory)"
            [isLocked]="equipmentsCategory.locked"
          ></app-lock-button>
        </div>
      </div>
      <div *ngFor="let trait of equipmentsCategory.traits" class="card mb-3">
        <ng-container
          *ngTemplateOutlet="equipmentTrait; context: { trait: trait }"
        ></ng-container>
      </div>
    </div>
  </div>
</div>

<ng-template #randomizedTrait let-category="category" let-trait="trait">
  <h6 class="">
    {{ trait.name }}
  </h6>
  <div class="flex">
    <p class="flex-grow text-lg font-semibold" style="min-height: 24px">
      {{ trait.selected }}
    </p>
    <div class="flex gap-1">
      <app-reroll-button
        *ngIf="!trait.locked"
        (onClick)="rollTrait(trait)"
      ></app-reroll-button>
      <app-lock-button
        (onClick)="toggleTraitLock(category, trait)"
        [isLocked]="trait.locked"
      ></app-lock-button>
    </div>
  </div>
</ng-template>

<ng-template #equipmentTrait let-trait="trait">
  <div class="flex">
    <div
      class="flex items-center rounded-lg px-3"
      [style.backgroundColor]="trait.color"
    >
      <img src="./assets/icons/{{ trait.icon }}.svg" alt="" class="w-9 h-9" />
    </div>
    <p class="flex-grow text-lg font-semibold self-center text-center">
      {{ trait.selected }}
    </p>
    <div class="flex flex-col justify-between">
      <app-reroll-button
        *ngIf="!trait.locked"
        (onClick)="rollTrait(trait)"
      ></app-reroll-button>
      <app-lock-button
        (onClick)="toggleTraitLock(equipmentsCategory, trait)"
        [isLocked]="trait.locked"
      ></app-lock-button>
    </div>
  </div>
</ng-template>
